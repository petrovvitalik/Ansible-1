FROM ubuntu:20.04
ENV TZ=Europe/Moscow
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
RUN apt update && \
    apt install openssh-client git maven -y
RUN mkdir -p /root/.ssh
ADD /root/id_rsa /root/.ssh/
RUN chmod 700 /root/.ssh/id_rsa
RUN git config --global user.name "Docker-Maven" && git config --global user.email "nomad@ag.ru"
RUN git clone https://github.com/boxfuse/boxfuse-sample-java-war-hello.git
RUN cd /boxfuse-sample-java-war-hello && mvn package
RUN ssh-keyscan -p 2020 193.122.59.82 >> /root/.ssh/known_hosts
RUN git clone ssh://git@193.122.59.82:2020/petrovvitalik/Artifact-1.git
RUN cp -r /boxfuse-sample-java-war-hello/target/* /Artifact-1
RUN cd /Artifact-1/ && git add .
RUN cd /Artifact-1/ && git commit -q -m "Artifact"
RUN cd /Artifact-1/ && git push